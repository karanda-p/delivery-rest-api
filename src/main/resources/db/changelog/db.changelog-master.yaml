databaseChangeLog:
  - logicalFilePath: db/chanhelog/db.changelog-master.yaml
  - changeSet:
      id: create_customer_table
      author: p.karanda
      changes:
        - createTable:
            tableName: customer
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: login
                  type: varchar(50)
              - column:
                  name: password
                  type: varchar(50)
              - column:
                  name: phone
                  type: varchar(15)

  - changeSet:
      id: create_order_table
      author: p.karanda
      changes:
        - createTable:
            tableName: order
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: customer_id
                  type: BIGINT
              - column:
                  name: restaurant_id
                  type: BIGINT
              - column:
                  name: adress
                  type: varchar(64)
              - column:
                  name: status
                  type: varchar(30)
              - column:
                  name: creation_date
                  type: varchar(50)
              - column:
                  name: done_date
                  type: varchar(50)
              - column:
                  name: amount
                  type: numeric
              - column:
                  name: cart_id
                  type: BIGINT

  - changeSet:
      id: create_order_item
      author: p.karanda
      changes:
        - createTable:
            tableName: order_item
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: product_id
                  type: BIGINT
              - column:
                  name: quantity
                  type: int
              - column:
                  name: order_id
                  type: BIGINT

  - changeSet:
      id: create_cart
      author: p.karanda
      changes:
        - createTable:
            tableName: cart
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
                    nullable: fasle
              - column:
                  name: customer_id
                  type: BIGINT

  - changeSet:
      id: create_cart_item
      author: p.karanda
      changes:
        - createTable:
            tableName: cart_item
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: product_id
                  type: BIGINT
              - column:
                  name: quantity
                  type: int
              - column:
                  name: cart_id
                  type: BIGINT

  - changeSet:
      id: create_product
      author: p.karanda
      changes:
        - createTable:
            tableName: product
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: restaurant_id
                  type: BIGINT
              - column:
                  name: price
                  type: numeric

  - changeSet:
      id: create_restaurant
      author: p.karanda
      changes:
        - createTable:
            tableName: restaurant
            columns:
              - column:
                  name: id
                  type: BIGINT
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: name
                  type: varchar(50)
              - column:
                  name: category
                  type: varchar(30)

  - changeSet:
      id: add_fk_to_order_table
      author: p.karanda
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: customer_id
            baseTableName: order
            constraintName: fk_order_customer_id
            referencedTableName: customer
            referencedColumnNames: id

        - addForeignKeyConstraint:
            baseColumnNames: restaurant_id
            baseTableName: order
            constraintName: fk_order_restaurant_id
            referencedTableName: restaurant
            referencedColumnNames: id

        - addForeignKeyConstraint:
            baseColumnNames: cart_id
            baseTableName: order
            constraintName: fk_order_cart_id
            referencedTableName: cart
            referencedColumnNames: id

  - changeSet:
      id: add_fk_to_cart_table
      author: p.karanda
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: customer_id
            baseTableName: cart
            constraintName: fk_cart_customer_id
            referencedTableName: customer
            referencedColumnNames: id

  - changeSet:
      id: add_fk_to_cart_item_table
      author: p.karanda
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: product_id
            baseTableName: cart_item
            constraintName: fk_cart_item_product_id
            referencedTableName: product
            referencedColumnNames: id
        - addForeignKeyConstraint:
            baseColumnNames: cart_id
            baseTableName: cart_item
            constraintName: fk_cart_item_cart_id
            referencedTableName: cart
            referencedColumnNames: id

  - changeSet:
      id: add_fk_to_product_table
      author: p.karanda
      changes:
        - addForeignKeyConstraint:
            baseColumnNames: restaurant_id
            baseTableName: product
            constraintName: fk_product_restaurant_id
            referencedTableName: restaurant
            referencedColumnNames: id

  - changeSet:
      id: rename_column_address_order_table
      author: p.karanda
      changes:
        - renameColumn:
            oldColumnName: adress
            newColumnName: address
            tableName: order

  - changeSet:
      id: fill_restaurant_table
      author: p.karanda
      changes:
        - insert:
            tableName: restaurant
            columns:
              - column:
                  name: id
                  valueNumeric: 1
              - column:
                  name: name
                  value: McDonalds
              - column:
                  name: category
                  value: Burgers
        - insert:
            tableName: restaurant
            columns:
              - column:
                  name: id
                  valueNumeric: 2
              - column:
                  name: name
                  value: Burger King
              - column:
                  name: category
                  value: Burgers

  - changeSet:
      id: add_column_name_to_product_table
      author: p.karanda
      changes:
        - addColumn:
            tableName: product
            columns:
              name: name
              type: varchar(128)

  - changeSet:
      id: fill_product_table
      author: p.karanda
      changes:
        - insert:
            tableName: product
            columns:
              - column:
                  name: id
                  valueNumeric: 1
              - column:
                  name: restaurant_id
                  valueNumeric: 1
              - column:
                  name: price
                  valueNumeric: 135
              - column:
                  name: name
                  value: Big Mac
        - insert:
            tableName: product
            columns:
              - column:
                  name: id
                  valueNumeric: 2
              - column:
                  name: restaurant_id
                  valueNumeric: 1
              - column:
                  name: price
                  valueNumeric: 45
              - column:
                  name: name
                  value: Hamburger
        - insert:
            tableName: product
            columns:
              - column:
                  name: id
                  valueNumeric: 3
              - column:
                  name: restaurant_id
                  valueNumeric: 1
              - column:
                  name: price
                  valueNumeric: 55
              - column:
                  name: name
                  value: Cheaseburger

  - changeSet:
      id: fill_product_table_another
      author: p.karanda
      changes:
        - insert:
            tableName: product
            columns:
              - column:
                  name: id
                  valueNumeric: 4
              - column:
                  name: restaurant_id
                  valueNumeric: 2
              - column:
                  name: price
                  valueNumeric: 135
              - column:
                  name: name
                  value: Vopper
        - insert:
            tableName: product
            columns:
              - column:
                  name: id
                  valueNumeric: 5
              - column:
                  name: restaurant_id
                  valueNumeric: 2
              - column:
                  name: price
                  valueNumeric: 45
              - column:
                  name: name
                  value: Double Vopper
        - insert:
            tableName: product
            columns:
              - column:
                  name: id
                  valueNumeric: 6
              - column:
                  name: restaurant_id
                  valueNumeric: 2
              - column:
                  name: price
                  valueNumeric: 55
              - column:
                  name: name
                  value: Cheaseburger

  - changeSet:
      id: create_sequences_for_tables
      author: p.karanda
      changes:
        - createSequence:
            sequenceName: customer_seq
        - createSequence:
            sequenceName: order_seq
        - createSequence:
            sequenceName: cart_seq
        - createSequence:
            sequenceName: cart_item_seq
        - createSequence:
            sequenceName: restaurant_seq
        - createSequence:
            sequenceName: order_item_seq
        - createSequence:
            sequenceName: product_seq

  - changeSet:
      id: add_cart_id_column_to_customer_table
      author: p.karanda
      changes:
        - addColumn:
            tableName: customer
            column:
              name: cart_id
              type: BIGINT
        - addForeignKeyConstraint:
            baseColumnNames: cart_id
            baseTableName: customer
            constraintName: fk_customer_cart_id
            referencedTableName: cart
            referencedColumnNames: id

  - changeSet:
      id: delete_column_customer_id_from_cart_table
      author: p.karanda
      changes:
        - dropColumn:
            columnName: customer_id
            tableName: cart

  - changeSet:
      id: add_creation_date_column_to_cart_table
      author: p.karanda
      changes:
        - addColumn:
            tableName: cart
            column:
              name: creation_date
              type: varchar(50)

  - changeSet:
      id: delete_cart_id_column_from_order_table
      author: p.karanda
      changes:
        - dropColumn:
            columnName: cart_id
            tableName: order

  - changeSet:
      id: rename_table_order_to_orders
      author: p.karanda
      changes:
        - renameTable:
            newTableName: orders
            oldTableName: order